<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="./assets/favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#009b5c" />
    <meta name="description" content="Zero tracking, GDPR compliant URL shortener" />
    <meta property="og:url" content="{{PUBLIC_URL}}" />
    <meta property="og:title" content="Poda.me" />
    <meta property="og:description" content="Quickly create shortened URLs with zero tracking" />
    <meta property="og:image" content="./assets/social-card.png" />

    <meta name="msapplication-square512x512logo" content="/assets/logo.png" />
    <link rel="apple-touch-icon" href="./assets/logo.png" />
    <meta name="apple-mobile-web-app-title" content="Poda.me" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <title>Poda Me</title>
    <style>
      * {
        font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans,
          Droid Sans, Helvetica Neue, Helvetica, sans-serif;
        box-sizing: border-box;
        font-size: 1rem;
      }
      button {
        background: none;
        border: none;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 10px;
        border-radius: 4px;
      }
      button svg {
        width: 25px;
        height: 25px;
        flex-shrink: 0;
      }
      a {
        text-decoration: none;
      }
      html,
      body {
        margin: 0;
        width: 100%;
        height: 100%;
      }
      body {
        background-color: #fff;
        color: #5e5e5e;
      }
      header {
        width: 100%;
        display: flex;
        align-items: center;
      }
      header img {
        margin-right: 10px;
        border-radius: 100%;
      }
      .indent {
        margin-left: 20px;
      }

      section {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
      .wrapper {
        width: 100%;
        height: 100%;
        margin: auto;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
      .center {
        width: 100%;
        height: 200px;
        margin: auto;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
      .input {
        width: 100%;
        margin: auto;
        display: flex;
        justify-content: center;
      }
      input {
        width: 40%;
        min-width: 280px;
        height: 50px;
        padding: 5px 10px;
        border-radius: 0;
        border: none;
        background: #eee;
        outline: none;
        color: black;
        border-radius: 3px;
      }
      button.generate {
        width: auto;
        height: 50px;
        margin-left: 10px;
        background: radial-gradient(#009b5c, #00be78);
        color: white;
        opacity: 0.8;
      }
      button.generate:hover:not(:disabled) {
        opacity: 1;
        cursor: pointer;
      }
      button.generate:disabled {
        opacity: 0.2;
        background: radial-gradient(#999, #ccc);
      }
      button.copy {
        background: #009b5c;
        color: white;
      }
      button.copy:hover {
        cursor: pointer;
        background: #00b96f;
      }
      button.copy svg,
      button.copy-code svg {
        margin-left: 10px;
        fill: white;
      }
      button.copy:hover svg {
        cursor: pointer;
      }
      .link {
        display: flex;
        align-items: center;
      }
      .logo {
        text-align: center;
      }
      .logo-img {
        width: 320px;
        height: 80px;
        background-size: cover;
        background-image: url('./assets/hero-logo-light.png');
      }
      .result {
        border-radius: 4px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        margin-top: 20px;
        visibility: hidden;
      }
      footer {
        width: 90%;
        min-width: 280px;
        padding: 20px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
      code {
        font-size: 0.75rem;
        font-family: 'source-code-pro', 'Menlo', 'Monaco', 'Consolas', 'Courier New', 'monospace';
        text-align: left;
        overflow: hidden;
        display: -webkit-box;
        -webkit-box-orient: vertical;
        -webkit-line-clamp: 2;
      }
      .copy-code {
        background: #666;
        color: white;
      }
      .copy-code:hover {
        background: #333;
        cursor: pointer;
      }
      footer .buttons {
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      footer .buttons a {
        background: #333;
        color: white;
        margin: 10px;
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 10px;
        border-radius: 4px;
      }
      footer .buttons a:hover {
        background: #009b5c;
      }
      footer a svg {
        width: 25px;
        height: 25px;
        margin-right: 10px;
        fill: white;
        flex-shrink: 0;
      }
      footer .studio-41 {
        text-align: center;
        margin-top: 20px;
      }
      footer .studio-41 a {
        color: #009b5c;
      }

      body.dark {
        background-color: #333;
        color: #eee;
      }
      .dark section {
        background: linear-gradient(to top, #3b3b3b, #525252);
      }
      .dark input[type='text'] {
        background: rgba(255, 255, 255, 0.4);
      }

      .logo-img {
        background-image: url('./assets/hero-logo-dark.png');
      }
      .dark footer .buttons a {
        background: #111;
      }
      .dark footer svg {
        fill: white;
      }
      @media only screen and (max-width: 600px) {
        .link, .input {
          flex-direction: column;
        }
        input {
          min-width: 320px;
          margin: auto;
        }

        button.generate {
          width: 150px;
          height: 40px;
          margin: 10px auto;
        }
        footer .buttons {
          flex-direction: column;
          width: 100%;
          margin-top: 20px;
        }
        footer .buttons a {
          width: 100%;
          margin: 5px;
        }
      }
    </style>
  </head>
  <body>
    <section>
      <div class="wrapper">
        <div class="center">
          <div class="logo">
            <div class="logo-img"></div>
            <p>Zero tracking URL shortener</p>
          </div>
          <div class="input">
            <input type="text" autocomplete="off" id="original_url"  onkeyup="handleOnKeyUp()" onkeydown="handleOnKeyDown()" />
            <label for="original_url" hidden>Enter your URL here</label>
            <button id="send" onclick="poda()" disabled class="generate" aria-label="Generate link">
              Podame
            </button>
          </div>
          <div class="result" id="result">
            <div class="link">
              <span style="margin-right: 5px">Your poda.me link: </span>
              <button id="send" onclick="javascript:copy()" class="copy" aria-label="Copy poda.me link">
                <span id="poda_url"></span>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                  <path d="M60,76.67v14.64c0,4.8-3.89,8.69-8.69,8.69H8.69c-4.8,0-8.69-3.89-8.69-8.69V36.02c0-4.8,3.89-8.69,8.69-8.69h27.31V63.98c0,6.99,5.69,12.69,12.69,12.69h11.31Zm40-12.69V8.69c0-4.8-3.89-8.69-8.69-8.69H48.69c-4.8,0-8.69,3.89-8.69,8.69V63.98c0,4.8,3.89,8.69,8.69,8.69h42.62c4.8,0,8.69-3.89,8.69-8.69Z" />
                </svg>
              </button>
            </div>
          </div>
        </div>
        <footer>
          <button onclick="javascript:copyCode()" class="copy-code" aria-label="Copy API call">
            <code id="original_url_clone">curl -X POST {{PUBLIC_URL}}?url=[URL]</code>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
              <path d="M60,76.67v14.64c0,4.8-3.89,8.69-8.69,8.69H8.69c-4.8,0-8.69-3.89-8.69-8.69V36.02c0-4.8,3.89-8.69,8.69-8.69h27.31V63.98c0,6.99,5.69,12.69,12.69,12.69h11.31Zm40-12.69V8.69c0-4.8-3.89-8.69-8.69-8.69H48.69c-4.8,0-8.69,3.89-8.69,8.69V63.98c0,4.8,3.89,8.69,8.69,8.69h42.62c4.8,0,8.69-3.89,8.69-8.69Z" />
            </svg>
          </button>
          <div class="buttons">
            <a href="https://hub.docker.com/r/relisio/poda.me" target="_blank" class="external">
              <!-- https://www.docker.com/company/newsroom/media-resources/ -->
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                <path d="M55.1,14.1c.38,.25,.51,.61,.51,1.06-.01,2.44,0,4.88,0,7.32,0,.77-.28,1.04-1.06,1.04-2.73,0-5.47,0-8.2,0-.87,0-1.11-.23-1.11-1.08,0-2.42,0-4.85,0-7.27,0-.46,.12-.81,.51-1.06h9.37ZM3.41,48.07c-1.91,0-3.52,1.36-3.41,3.43,.12,2.3,.21,4.62,.49,6.9,.63,5.04,2.04,9.85,4.54,14.3,2.86,5.09,6.96,8.69,12.52,10.6,4.95,1.7,10.07,2.39,15.27,2.56,3.12,.11,6.24-.03,9.35-.35,4.4-.46,8.69-1.38,12.86-2.84,9.67-3.37,17.33-9.32,22.99-17.84,2.6-3.92,4.64-8.13,6.37-12.5,.17-.43,.39-.57,.84-.56,2.18,.05,4.32-.23,6.36-1,4.02-1.52,6.92-4.18,8.34-8.33,.12-.34,.05-.53-.22-.76-1.11-.95-2.39-1.56-3.77-1.96-2.87-.82-5.77-.81-8.69-.37-.42,.06-.54-.06-.62-.44-.98-4.88-3.82-8.38-8.1-10.78-.29-.16-.46-.13-.66,.14-1.53,2.09-2.62,4.39-3.22,6.91-.88,3.71-.57,7.29,1.37,10.64,.24,.42,.18,.59-.25,.77-2.32,1-4.77,1.47-7.28,1.48-10.85,.03-21.7,.01-32.55,.01-10.85,0-21.7,.02-32.55-.02Zm22.44-13.23c1.36,0,2.72,0,4.08,0,.84,0,1.11-.26,1.11-1.1,0-2.39,0-4.78,0-7.17,0-.9-.27-1.17-1.16-1.17-2.71,0-5.41,0-8.12,0-.86,0-1.13,.28-1.14,1.14,0,2.41,0,4.82,0,7.22,0,.8,.28,1.08,1.09,1.08,1.38,0,2.76,0,4.13,0h0Zm16.52,0c.73,0,1.03-.3,1.03-1.03,0-2.44,0-4.88,0-7.32,0-.8-.29-1.08-1.09-1.08-2.74,0-5.48,0-8.22,0-.82,0-1.1,.29-1.1,1.12,0,2.41,0,4.81,0,7.22,0,.83,.28,1.09,1.12,1.1,1.36,0,2.72,0,4.08,0,1.39,0,2.79,0,4.18,0Zm16.07,1.9c-.59,0-.91,.29-.92,.88-.01,2.54-.01,5.08,0,7.62,0,.63,.31,.92,.93,.92,2.81,0,5.63,0,8.44,0,.75,0,1.03-.28,1.03-1.03,.01-2.46,0-4.91,0-7.37,0-.76-.28-1.02-1.03-1.02-1.38,0-2.76,0-4.13,0-1.44,0-2.89,0-4.33,0Zm-24.21,0c-1.05,0-1.25,.2-1.25,1.25,0,1.91,0,3.82,0,5.72,0,.51-.02,1.03,0,1.54,.03,.59,.31,.9,.85,.9,2.88,0,5.76,0,8.64,0,.62,0,.9-.28,.9-.88,.02-2.52,.02-5.05,0-7.57,0-.69-.3-.95-1-.95-1.39,0-2.79,0-4.18,0-1.33,0-2.66,0-3.98,0Zm-24.56,0c-1.01,0-1.22,.21-1.22,1.24,0,2.34,0,4.68,0,7.02,0,.91,.23,1.17,1.14,1.17,2.73,0,5.46,0,8.19-.01,.83,0,1.07-.24,1.08-1.07,.01-2.44,.01-4.88,0-7.32,0-.75-.3-1.02-1.04-1.02-1.39,0-2.79,0-4.18,0-1.33,0-2.66,0-3.98,0Zm11.98,0c-.72,0-1.01,.26-1.01,.99-.01,2.49-.01,4.98,0,7.48,0,.67,.3,.95,.95,.95,2.8,0,5.6,0,8.4,0,.77,0,1.05-.28,1.05-1.06,0-2.44,0-4.88,0-7.33,0-.77-.29-1.03-1.07-1.03-1.36,0-2.72,0-4.09,0-1.41,0-2.82,0-4.24,0Zm32.97-1.9c.7,0,.98-.27,.98-.96,0-2.51,0-5.01,0-7.52,0-.64-.3-.95-.95-.95-2.81,0-5.61-.01-8.42,0-.75,0-1,.29-1,1.05,0,2.46,0,4.91,0,7.37,0,.76,.25,1.01,1.02,1.01,1.38,0,2.76,0,4.13,0,1.41,0,2.82,0,4.23,0Zm-8.42,1.9c-.7,0-.97,.27-.97,.96,0,2.49,0,4.98,0,7.47,0,.7,.27,.98,.96,.99,2.82,0,5.63,0,8.45,0,.68,0,.96-.29,.96-.98,0-2.47,0-4.95,0-7.42,0-.76-.26-1.01-1.03-1.01-1.38,0-2.76,0-4.13,0-1.41,0-2.82,0-4.23,0Z" />
              </svg>
              Self-host using Docker
            </a>
            <a href="https://github.com/Studio-41/poda.me" target="_blank" class="external">
              <!-- https://github.com/logos -->
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                <path d="M50,0C22.39,0,0,22.39,0,50c0,22.09,14.33,40.83,34.2,47.44,2.5,.46,3.41-1.09,3.41-2.41,0-1.19-.04-4.33-.07-8.5-13.91,3.02-16.84-6.7-16.84-6.7-2.27-5.78-5.55-7.31-5.55-7.31-4.54-3.1,.34-3.04,.34-3.04,5.02,.35,7.66,5.15,7.66,5.15,4.46,7.64,11.7,5.43,14.55,4.15,.45-3.23,1.75-5.43,3.17-6.68-11.1-1.26-22.78-5.55-22.78-24.71,0-5.46,1.95-9.92,5.15-13.42-.51-1.26-2.23-6.35,.49-13.23,0,0,4.2-1.34,13.75,5.13,3.99-1.11,8.27-1.66,12.52-1.68,4.25,.02,8.52,.57,12.52,1.68,9.55-6.47,13.74-5.13,13.74-5.13,2.73,6.88,1.01,11.97,.5,13.23,3.2,3.5,5.14,7.96,5.14,13.42,0,19.21-11.69,23.43-22.83,24.67,1.8,1.54,3.39,4.6,3.39,9.26,0,6.68-.06,12.08-.06,13.72,0,1.34,.9,2.89,3.44,2.4,19.85-6.62,34.16-25.35,34.16-47.44C100,22.39,77.61,0,50,0Z" />
              </svg>
              Fork on GitHub
            </a>
          </div>

          <div class="studio-41">
            Poda.me is a FOSS by <a href="https://41.studio" target="_blank">Studio 41 Software Design S.L.</a> in
            Barcelona, Spain<br/>
            hosted at <a href="https://clouding.io" target="_blank">clouding.io</a>
          </div>
        </footer>
      </div>
    </section>
  </body>
  <script>
    function validateUrl(x) {
      return x && x.length > 0
    }

    function handleOnKeyDown() {
      document.getElementById('result').style.visibility = 'hidden'
      document.getElementById('poda_url').innerHTML = ''

      if (event.keyCode === 13) {
        poda()
        return
      }
    }

    function handleOnKeyUp() {
      var isValid = validateUrl(document.getElementById('original_url').value.trim())

      // disable/enable button
      document.getElementById('send').disabled = !isValid

        document.getElementById('original_url_clone').innerText = isValid ? 
        'curl -X POST {{PUBLIC_URL}}?url=' + document.getElementById('original_url').value.trim() :
        'curl -X POST {{PUBLIC_URL}}?url=[URL]' 
    }

    function poda() {
      document.getElementById('poda_url').innerHTML = ''
      var url = document.getElementById('original_url').value.trim()
      var isValid = validateUrl(url)
      if (!isValid) {
        return
      }
      document.getElementById('send').disabled = true
      var xhr = new XMLHttpRequest()
      xhr.open('POST', `/?url=${url}`, true)
      xhr.setRequestHeader('Content-Type', 'application/json')
      xhr.onreadystatechange = function () {
        if (xhr.readyState == 4) {
          var response = JSON.parse(xhr.responseText)
          document.getElementById('poda_url').innerHTML = response.url
          document.getElementById('original_url').value = ''
          document.getElementById('original_url_clone').value = 'curl -X POST {{PUBLIC_URL}}?url=[URL]'
          document.getElementById('result').style.visibility = 'visible'
          document.getElementById('original_url').focus()
        }
      }
      xhr.send()
    }

    function _copy(id) {
      var value = document.getElementById(id).innerHTML
      navigator.clipboard.writeText(value)

      document.getElementById(id).innerHTML = 'copied!'

      setTimeout(function () {
        document.getElementById(id).innerHTML = value
      }, 2800)
    }

    function copyCode() {
      _copy('original_url_clone')
    }

    function copy() {
      _copy('poda_url')
    }

    document.getElementById('original_url').focus()

    if (!navigator || !navigator.clipboard || !window.isSecureContext) {
      document.getElementById('copy_btn').style.visibility = 'hidden'
    }

    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      document.getElementsByTagName('body')[0].classList.add('dark')
    }
  </script>
</html>
